{% extends 'core/base.html' %}
{% load static %}

{% block title %}Student Questionnaire{% endblock %}

{% block content %}
<div class="container mx-auto mt-10">
  {% if not has_completed_questionnaires %}
    <h1 class="page-title">
      Welcome {{ student.first_name }} {{ student.last_name }}.
    </h1>
    <p class="text-primary-dark-teal text-lg font-light text-center">
      Please complete your Pre-appointment Questionnaire.
    </p>
  {% else %}
    <h1 class="page-title">
      Pre-appointment Questionnaire Response for {{ student.first_name }} {{ student.last_name }}
    </h1>
  {% endif %}

  <hr class="page-divider"> <!-- Divider after Welcome Message -->
  <!-- ðŸ†• Display User Info for Admins and Teachers -->
  <div class="bg-white shadow-md rounded-lg p-4 mb-6">
    <div class="flex items-center justify-between">
      
      <!-- Left: Avatar and Stacked Name -->
      <div class="flex items-center space-x-4">
        <!-- Avatar -->
        <div class="flex-shrink-0">
          {% if student.studentprofile.profile_picture %}
            <img src="{{ student.studentprofile.profile_picture.url }}" alt="{{ student.email }}"
                class="w-16 h-16 rounded-full object-cover">
          {% else %}
            <img src="{% static 'core/img/default-profile.png' %}" alt="Default Avatar"
                class="w-16 h-16 rounded-full object-cover">
          {% endif %}
        </div>
        <!-- Name Info -->
        <div class="flex flex-col leading-tight text-base">
          <div>
            <span class="text-gray-500">First Name: </span>
            <span class="font-semibold text-primary-dark-teal">{{ student.first_name }}</span>
          </div>
          <div>
            <span class="text-gray-500">Last Name: </span>
            <span class="font-semibold text-primary-dark-teal">{{ student.last_name }}</span>
          </div>
        </div>
      </div>

      <!-- Right: Email -->
      <div class="flex items-center space-x-2 text-base text-gray-700">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
            stroke-width="1.5" stroke="currentColor"
            class="w-6 h-6 text-deep-teal flex-shrink-0">
          <path stroke-linecap="round" stroke-linejoin="round"
                d="M16.5 12a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0Zm0 0c0 1.657 1.007 3 
                  2.25 3S21 13.657 21 12a9 9 0 1 0-2.636 6.364M16.5 12V8.25" />
        </svg>
        <div>
          <span class="text-gray-500">Email: </span>
          <span class="font-semibold text-primary-dark-teal">{{ student.email }}</span>
        </div>
      </div>

    </div>
  </div>

  <div class="bg-white shadow-md rounded-lg p-6 mb-24">
    {% if is_editing %}
      <!-- Edit Mode -->
      <h2 class="flex items-center justify-center text-primary-dark-teal text-lg font-light mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 mr-2">
          <path d="M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-8.4 8.4a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32l8.4-8.4Z" />
          <path d="M5.25 5.25a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h10.5a3 3 0 0 0 3-3V13.5a.75.75 0 0 0-1.5 0v5.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5V8.25a1.5 1.5 0 0 1 1.5-1.5h5.25a.75.75 0 0 0 0-1.5H5.25Z" />
        </svg>
        Edit Your Questionnaire
      </h2>
      <hr class="page-divider">

      <form method="POST" class="space-y-6">
        {% csrf_token %}
        <!-- Faculty / Department -->
        <h3 class="text-primary-dark-teal text-lg font-light">
          Faculty / Department
        </h3>
        <div class="mb-2">
          <div class="relative">
            <input
              type="text"
              name="faculty_department"
              id="id_faculty_department"
              value="{{ form.faculty_department.value|default:'' }}"
              class="peer block min-h-[auto] w-full rounded border border-gray-300 bg-white px-3 py-[0.32rem]
                    leading-[2.15] outline-none transition-all duration-200 ease-linear placeholder-transparent
                    peer-focus:border-primary-dark-teal peer-focus:ring-primary-dark-teal peer-valid:border-primary-dark-teal"
              placeholder="Faculty or Department"
              required
            />
            <label
              for="id_faculty_department"
              class="pointer-events-none absolute left-3 top-0 mb-0 origin-[0_0] truncate
                    pt-[0.37rem] leading-[2.15] text-neutral-500 transition-all duration-200 ease-out
                    peer-focus:-translate-y-[1.15rem] peer-focus:scale-[0.8]
                    peer-valid:-translate-y-[1.15rem] peer-valid:scale-[0.8]"
            >
              Faculty / Department
            </label>
          </div>
          {% if form.faculty_department.help_text %}
            <p class="mt-0.5 text-sm font-medium text-warm-brown">
              {{ form.faculty_department.help_text }}
            </p>
          {% endif %}
        </div>
        <hr class="page-divider">

        <!-- Mother Tongue -->
        <h3 class="text-primary-dark-teal text-lg font-light">
          Mother Tongue
        </h3>
        <div class="mb-2">
          <div class="relative">
            <input
              type="text"
              name="mother_tongue"
              id="id_mother_tongue"
              value="{{ form.mother_tongue.value|default:'' }}"
              class="peer block min-h-[auto] w-full rounded border border-gray-300 bg-white px-3 py-[0.32rem]
                    leading-[2.15] outline-none transition-all duration-200 ease-linear placeholder-transparent
                    peer-focus:border-primary-dark-teal peer-focus:ring-primary-dark-teal peer-valid:border-primary-dark-teal"
              placeholder="e.g., English, Spanish, Mandarin"
              required
            />
            <label
              for="id_mother_tongue"
              class="pointer-events-none absolute left-3 top-0 mb-0 origin-[0_0] truncate
                    pt-[0.37rem] leading-[2.15] text-neutral-500 transition-all duration-200 ease-out
                    peer-focus:-translate-y-[1.15rem] peer-focus:scale-[0.8]
                    peer-valid:-translate-y-[1.15rem] peer-valid:scale-[0.8]"
            >
              Mother Tongue
            </label>
          </div>
          {% if form.mother_tongue.help_text %}
            <p class="mt-0.5 text-sm font-medium text-warm-brown">
              {{ form.mother_tongue.help_text }}
            </p>
          {% endif %}
        </div>

        <hr class="page-divider">

        <!-- University Status -->
        <fieldset class="grid grid-cols-1 sm:grid-cols-2 gap-3 bg-white mb-6 rounded-md">
          <legend class="text-primary-dark-teal text-lg font-light mb-4 col-span-full">
            University Status
            <br>
            <span class="text-sm font-medium text-warm-brown">Please select the option that best drscribes your university status</span>
          </legend>


          {% for radio in form.university_status %}
            <label class="flex items-center border border-gray-200 rounded-md p-4 cursor-pointer hover:bg-gray-50">
              <input
                type="radio"
                name="{{ radio.data.name }}"
                value="{{ radio.data.value }}"
                id="{{ radio.id_for_label }}"
                {% if radio.data.attrs.checked %}checked{% endif %}
                class="peer mr-4 h-5 w-5 text-primary-dark-teal border-gray-300 focus:ring-primary-dark-teal"
              />
              <span class="text-base text-gray-800 peer-checked:text-primary-dark-teal">
                {{ radio.choice_label }}
              </span>
            </label>
          {% endfor %}
        </fieldset>

        <hr class="page-divider">

        <!-- Mandatory Language Name -->
        <h3 class="text-primary-dark-teal text-lg font-light">
          Main Language to Learn or Improve
        </h3>
        <div class="mb-2">
          <div class="relative">
            <input
              type="text"
              name="language_mandatory_name"
              id="id_language_mandatory_name"
              value="{{ form.language_mandatory_name.value|default:'' }}"
              class="peer block min-h-[auto] w-full rounded border border-gray-300 bg-white px-3 py-[0.32rem]
                    leading-[2.15] outline-none transition-all duration-200 ease-linear placeholder-transparent
                    peer-focus:border-primary-dark-teal peer-focus:ring-primary-dark-teal peer-valid:border-primary-dark-teal"
              placeholder="e.g., Spanish"
              required
            />
            <label
              for="id_language_mandatory_name"
              class="pointer-events-none absolute left-3 top-0 mb-0 origin-[0_0] truncate
                    pt-[0.37rem] leading-[2.15] text-neutral-500 transition-all duration-200 ease-out
                    peer-focus:-translate-y-[1.15rem] peer-focus:scale-[0.8]
                    peer-valid:-translate-y-[1.15rem] peer-valid:scale-[0.8]"
            >
              Main Language
            </label>
          </div>
          {% if form.language_mandatory_name.help_text %}
            <p class="mt-0.5 text-sm font-medium text-warm-brown">
              {{ form.language_mandatory_name.help_text }}
            </p>
          {% endif %}
        </div>

        <hr class="page-divider">

        <!-- Mandatory Language Proficiency -->
        <fieldset class="grid grid-cols-1 sm:grid-cols-3 gap-3 bg-white mb-6 rounded-md">
          <legend class="text-primary-dark-teal text-lg font-light mb-4 col-span-full">
            Proficiency Level
          </legend>
          {% for radio in form.language_mandatory_proficiency %}
            <label class="flex items-center border border-gray-200 rounded-md p-4 cursor-pointer hover:bg-gray-50">
              <input
                type="radio"
                name="{{ radio.data.name }}"
                value="{{ radio.data.value }}"
                id="{{ radio.id_for_label }}"
                {% if radio.data.attrs.checked %}checked{% endif %}
                class="peer mr-4 h-5 w-5 text-primary-dark-teal border-gray-300 focus:ring-primary-dark-teal"
              />
              <span class="text-base text-gray-800 peer-checked:text-primary-dark-teal">
                {{ radio.choice_label }}
              </span>
            </label>
          {% endfor %}
        </fieldset>

        <hr class="page-divider">

        <!-- Mandatory Language Learning Goals -->
        <fieldset class="grid grid-cols-1 sm:grid-cols-2 gap-3 bg-white mb-6 rounded-md">
          <legend class="text-primary-dark-teal text-lg font-light mb-4 col-span-full">
            Learning / Development Goals
            <br>
            <span class="text-sm font-medium text-warm-brown">
              Please select at least one goal.
            </span>
          </legend>
          {% for checkbox in form.language_mandatory_goals %}
            <label class="flex items-center border border-gray-200 rounded-md p-4 cursor-pointer hover:bg-gray-50">
              <input
                type="checkbox"
                name="{{ checkbox.data.name }}"
                value="{{ checkbox.data.value }}"
                id="{{ checkbox.id_for_label }}"
                {% if checkbox.data.attrs.checked %}checked{% endif %}
                class="peer mr-4 h-5 w-5 text-primary-dark-teal border-gray-300 focus:ring-primary-dark-teal"
              />
              <span class="text-base text-gray-800 peer-checked:text-primary-dark-teal">
                {{ checkbox.choice_label }}
              </span>
            </label>
          {% endfor %}
        </fieldset>

        <hr class="page-divider">

        <!-- Optional Language Name -->
        <h3 class="text-primary-dark-teal text-lg font-light">
          Additional Language to Learn or Improve (Optional)
        </h3>
        <div class="mb-2">
          <div class="relative">
            <input
              type="text"
              name="language_optional_name"
              id="id_language_optional_name"
              value="{{ form.language_optional_name.value|default:'' }}"
              class="peer block min-h-[auto] w-full rounded border border-gray-300 bg-white px-3 py-[0.32rem]
                    leading-[2.15] outline-none transition-all duration-200 ease-linear placeholder-transparent
                    peer-focus:border-primary-dark-teal peer-focus:ring-primary-dark-teal peer-valid:border-primary-dark-teal"
              placeholder="e.g., French"
            />
            <label
              for="id_language_optional_name"
              class="pointer-events-none absolute left-3 top-0 mb-0 origin-[0_0] truncate
                    pt-[0.37rem] leading-[2.15] text-neutral-500 transition-all duration-200 ease-out
                    peer-focus:-translate-y-[1.15rem] peer-focus:scale-[0.8]
                    peer-valid:-translate-y-[1.15rem] peer-valid:scale-[0.8]"
            >
              Additional Language (Optional)
            </label>
          </div>
          {% if form.language_optional_name.help_text %}
            <p class="mt-0.5 text-sm font-medium text-warm-brown">
              {{ form.language_optional_name.help_text }}
            </p>
          {% endif %}
        </div>

        <hr class="page-divider">

        <!-- Optional Language Proficiency -->
        <fieldset class="grid grid-cols-1 sm:grid-cols-3 gap-3 bg-white mb-6 rounded-md">
          <legend class="text-primary-dark-teal text-lg font-light mb-4 col-span-full">
            Proficiency Level (Optional)
          </legend>
          {% for radio in form.language_optional_proficiency %}
            <label class="flex items-center border border-gray-200 rounded-md p-4 cursor-pointer hover:bg-gray-50">
              <input
                type="radio"
                name="{{ radio.data.name }}"
                value="{{ radio.data.value }}"
                id="{{ radio.id_for_label }}"
                {% if radio.data.attrs.checked %}checked{% endif %}
                class="peer mr-4 h-5 w-5 text-primary-dark-teal border-gray-300 focus:ring-primary-dark-teal"
              />
              <span class="text-base text-gray-800 peer-checked:text-primary-dark-teal">
                {{ radio.choice_label }}
              </span>
            </label>
          {% endfor %}
        </fieldset>

        <hr class="page-divider">

        <!-- Optional Language Learning Goals -->
        <fieldset class="grid grid-cols-1 sm:grid-cols-2 gap-3 bg-white mb-6 rounded-md">
          <legend class="text-primary-dark-teal text-lg font-light mb-4 col-span-full">
            Learning / Development Goals (Optional)
          </legend>
          {% for checkbox in form.language_optional_goals %}
            <label class="flex items-center border border-gray-200 rounded-md p-4 cursor-pointer hover:bg-gray-50">
              <input
                type="checkbox"
                name="{{ checkbox.data.name }}"
                value="{{ checkbox.data.value }}"
                id="{{ checkbox.id_for_label }}"
                {% if checkbox.data.attrs.checked %}checked{% endif %}
                class="peer mr-4 h-5 w-5 text-primary-dark-teal border-gray-300 focus:ring-primary-dark-teal"
              />
              <span class="text-base text-gray-800 peer-checked:text-primary-dark-teal">
                {{ checkbox.choice_label }}
              </span>
            </label>
          {% endfor %}
        </fieldset>

        <hr class="page-divider">
        
        <!-- Mandatory Aspects to Improve -->        
        <div class="mb-6">
          <h3 class="text-primary-dark-teal text-lg font-light">
          Aspects to Improve
        </h3>
          <div class="relative">
            <textarea
              name="aspects_to_improve"
              id="id_aspects_to_improve"
              maxlength="2000"
              rows="3"
              placeholder="E.g. speaking, pronunciation, listening, grammarâ€¦"
              class="peer block min-h-[auto] w-full rounded border border-gray-300 bg-white px-3 py-[0.32rem]
                    leading-[2.15] outline-none transition-all duration-200 ease-linear placeholder-transparent
                    peer-focus:border-primary-dark-teal peer-focus:ring-primary-dark-teal peer-valid:border-primary-dark-teal"
              required
            >{{ form.aspects_to_improve.value|default_if_none:'' }}</textarea>

            <label
              for="id_aspects_to_improve"
              class="pointer-events-none absolute left-3 top-0 mb-0 origin-[0_0] truncate
                    pt-[0.37rem] leading-[2.15] text-neutral-500 transition-all duration-200 ease-out
                    peer-focus:-translate-y-[1.15rem] peer-focus:scale-[0.8]
                    peer-valid:-translate-y-[1.15rem] peer-valid:scale-[0.8]"
            >
              E.g. conversation skills, pronunciation, listening comprehension, grammar, writing
            </label>
          </div>

          {% if form.aspects_to_improve.help_text %}
            <p class="mt-0.5 text-sm font-medium text-warm-brown">
              {{ form.aspects_to_improve.help_text }}
            </p>
          {% endif %}

          {% if form.aspects_to_improve.errors %}
            <p class="text-sm text-red-600">{{ form.aspects_to_improve.errors }}</p>
          {% endif %}
        </div>


        <!-- Activities You Can Manage -->        
        <div class="mb-6">
          <h3 class="text-primary-dark-teal text-lg font-light">
            Activities You Can Manage
          </h3>
          <div class="relative">
            <textarea
              name="activities_you_can_manage"
              id="id_activities_you_can_manage"
              maxlength="2000"
              rows="3"
              placeholder="E.g. reading newspapers, watching films without subtitles, giving presentationsâ€¦"
              class="peer block min-h-[auto] w-full rounded border border-gray-300 bg-white px-3 py-[0.32rem]
                    leading-[2.15] outline-none transition-all duration-200 ease-linear placeholder-transparent
                    peer-focus:border-primary-dark-teal peer-focus:ring-primary-dark-teal peer-valid:border-primary-dark-teal"
              required
            >{{ form.activities_you_can_manage.value|default_if_none:'' }}</textarea>

            <label
              for="id_activities_you_can_manage"
              class="pointer-events-none absolute left-3 top-0 mb-0 origin-[0_0] truncate
                    pt-[0.37rem] leading-[2.15] text-neutral-500 transition-all duration-200 ease-out
                    peer-focus:-translate-y-[1.15rem] peer-focus:scale-[0.8]
                    peer-valid:-translate-y-[1.15rem] peer-valid:scale-[0.8]"
            >
              E.g. reading newspapers, casual conversations, watching films, writing emails, listening to podcasts
            </label>
          </div>

          {% if form.activities_you_can_manage.help_text %}
            <p class="mt-0.5 text-sm font-medium text-warm-brown">
              {{ form.activities_you_can_manage.help_text }}
            </p>
          {% endif %}

          {% if form.activities_you_can_manage.errors %}
            <p class="text-sm text-red-600">{{ form.activities_you_can_manage.errors }}</p>
          {% endif %}
        </div>







        
        <!-- Question 1 -->
        <div class="relative mb-6">
          <input type="text" name="question1" id="id_question1" value="{{ form.question1.value|default:'' }}"
            class="peer block min-h-[auto] w-full rounded border border-gray-300 bg-white px-3 py-[0.32rem] leading-[2.15] outline-none transition-all duration-200 ease-linear placeholder-transparent peer-focus:border-primary-dark-teal peer-focus:ring-primary-dark-teal peer-valid:border-primary-dark-teal"
            placeholder="Question 1" required />
          <label for="id_question1"
            class="pointer-events-none absolute left-3 top-0 mb-0 origin-[0_0] truncate pt-[0.37rem] leading-[2.15] text-neutral-500 transition-all duration-200 ease-out peer-focus:-translate-y-[1.15rem] peer-focus:scale-[0.8] peer-valid:-translate-y-[1.15rem] peer-valid:scale-[0.8] dark:text-neutral-400 dark:peer-focus:text-primary">
            Question 1
          </label>
        </div>

        <!-- Question 2 -->
        <div class="relative mb-6">
          <input type="text" name="question2" id="id_question2" value="{{ form.question2.value|default:'' }}"
            class="peer block min-h-[auto] w-full rounded border border-gray-300 bg-white px-3 py-[0.32rem] leading-[2.15] outline-none transition-all duration-200 ease-linear placeholder-transparent peer-focus:border-primary-dark-teal peer-focus:ring-primary-dark-teal peer-valid:border-primary-dark-teal"
            placeholder="Question 2" required />
          <label for="id_question2"
            class="pointer-events-none absolute left-3 top-0 mb-0 origin-[0_0] truncate pt-[0.37rem] leading-[2.15] text-neutral-500 transition-all duration-200 ease-out peer-focus:-translate-y-[1.15rem] peer-focus:scale-[0.8] peer-valid:-translate-y-[1.15rem] peer-valid:scale-[0.8] dark:text-neutral-400 dark:peer-focus:text-primary">
            Question 2
          </label>
        </div>

        <!-- Save Changes Button -->
        <div class="flex justify-end space-x-4">
          <button type="submit"
            class="inline-flex items-center bg-warm-brown text-white px-6 py-2 text-sm font-medium leading-normal rounded-lg shadow-lg transition duration-150 ease-in-out hover:bg-dark-orange focus:bg-dark-orange focus:outline-none focus:ring-2 focus:ring-warm-brown focus:ring-opacity-50">
            <!-- Save Icon -->
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mr-2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M5 12.5l4 4L19 7M5 12.5H4v5.25A2.25 2.25 0 006.25 20.5h11.5A2.25 2.25 0 0020 18.25V13h-1" />
            </svg>
            Save Changes
          </button>
          <a href="{% url 'questionnaire' %}" 
            class="inline-flex items-center bg-gray-200 text-gray-800 px-6 py-2 text-sm font-medium leading-normal rounded-lg shadow-lg transition duration-150 ease-in-out hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400">
            Cancel
          </a>
        </div>
      </form>
    {% else %}
      <!-- Read-Only Mode -->
      {% if questionnaires %}
        <h2 class="text-lg font-semibold text-gray-900 mb-4">Previous Submissions</h2>
        <ul class="divide-y divide-gray-300">
          {% for questionnaire in questionnaires %}
            <li class="py-4">
              <p class="text-sm text-gray-500">Submitted on: {{ questionnaire.created_at|date:"F j, Y, g:i a" }}</p>
              
              <p class="text-gray-800">
                <strong>Faculty / Department:</strong>
                {{ questionnaire.faculty_department|default:"Not provided" }}
              </p>

              <p class="text-gray-800">
                <strong>Mother Tongue:</strong>
                {{ questionnaire.mother_tongue|default:"Not provided" }}
              </p>

              <p class="text-gray-800">
                <strong>University Status:</strong>
                {{ questionnaire.get_university_status_display|default:"Not provided" }}
              </p>

              <p class="text-gray-800">
                <strong>Main Language:</strong>
                {% if questionnaire.language_mandatory_name and questionnaire.language_mandatory_name != "Not specified" %}
                  {{ questionnaire.language_mandatory_name }}
                {% else %}
                  Not provided
                {% endif %}
              </p>

              <p class="text-gray-800">
                <strong>Proficiency Level:</strong>
                {% if questionnaire.language_mandatory_proficiency %}
                  {{ questionnaire.get_language_mandatory_proficiency_display }}
                {% else %}
                  Not provided
                {% endif %}
              </p>

              <p class="text-gray-800">
                <strong>Learning Goals:</strong>
                {% if questionnaire.language_mandatory_goals %}
                  <ul class="list-disc ml-5">
                    {% for goal in questionnaire.language_mandatory_goals %}
                      <li>
                        {% if goal == "personal_interest" %}Personal or general interest{% endif %}
                        {% if goal == "fieldwork" %}Fieldwork (oral communicative purposes){% endif %}
                        {% if goal == "academic_reading" %}Academic reading or other scholarship{% endif %}
                        {% if goal == "study_abroad" %}Preparation for work or study abroad{% endif %}
                        {% if goal == "other" %}Other{% endif %}
                      </li>
                    {% endfor %}
                  </ul>
                {% else %}
                  Not provided
                {% endif %}
              </p>

              <!-- Optional Language (if provided) -->
              {% if questionnaire.language_optional_name %}
                <p class="text-gray-800 mt-4">
                  <strong>Additional Language:</strong>
                  {{ questionnaire.language_optional_name }}
                </p>
              {% endif %}

              {% if questionnaire.language_optional_proficiency %}
                <p class="text-gray-800">
                  <strong>Additional Language Proficiency:</strong>
                  {{ questionnaire.get_language_optional_proficiency_display }}
                </p>
              {% endif %}

              {% if questionnaire.language_optional_goals %}
                <p class="text-gray-800">
                  <strong>Additional Language Goals:</strong>
                  <ul class="list-disc ml-5">
                    {% for goal in questionnaire.language_optional_goals %}
                      <li>
                        {% if goal == "personal_interest" %}Personal or general interest{% endif %}
                        {% if goal == "fieldwork" %}Fieldwork (oral communicative purposes){% endif %}
                        {% if goal == "academic_reading" %}Academic reading or other scholarship{% endif %}
                        {% if goal == "study_abroad" %}Preparation for work or study abroad{% endif %}
                        {% if goal == "other" %}Other{% endif %}
                      </li>
                    {% endfor %}
                  </ul>
                </p>
              {% endif %}

              <p class="text-gray-800"><strong>Question 1:</strong> {{ questionnaire.question1|default:"Not provided" }}</p>
              <p class="text-gray-800"><strong>Question 2:</strong> {{ questionnaire.question2|default:"Not provided" }}</p>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="text-gray-500 italic">No previous submissions available.</p>
      {% endif %}
    {% endif %}
  </div>

  <!-- Edit Button for Students -->
  {% if not is_editing and request.user.role == 'student' %}
    <div class="mb-20">
      <a href="?edit=true"
        class="flex items-center justify-center bg-deep-teal text-white px-4 py-2 rounded-lg hover:bg-teal-600 focus:outline-none focus:ring-2 focus:ring-primary-dark-teal focus:ring-opacity-50 w-full">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 mr-2">
          <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
        </svg>
        Edit Questionnaire
      </a>
    </div>
  {% endif %}

  <!-- Back to Student List Button (Visible only for admin/teacher) -->
  {% if request.user.role == 'admin' or request.user.role == 'teacher' %}
    <div class="mt-6 mb-20">
      <a href="{% url 'teacher_student_list' %}"
        class="flex items-center justify-center bg-deep-teal text-white px-4 py-2 rounded-lg hover:bg-teal-600 focus:outline-none focus:ring-2 focus:ring-primary-dark-teal focus:ring-opacity-50 w-full">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="h-5 w-5 mr-2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
        </svg>
        Back to Student List
      </a>
    </div>
  {% endif %}
</div>

{% endblock %}
