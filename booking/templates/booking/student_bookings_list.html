{# booking/templates/booking/student_bookings_list.html #}
{% extends "core/base.html" %}
{% block title %}My Upcoming Bookings{% endblock %}

{% block content %}
  <h1 class="text-3xl font-extralight text-gray-900 sm:text-4xl text-center mb-6">Your Upcoming Bookings</h1>
  <hr class="my-4 border-1 border-primary-dark-teal">

  {% if bookings %}
    <ul class="space-y-4">
      {% for b in bookings %}
        <li class="w-11/12 mx-auto bg-white p-4 rounded shadow flex items-center space-x-4">
          <img src="{{ b.teacher_avatar }}"
               alt="Advisor avatar"
               class="h-12 w-12 rounded-full object-cover border" />

          <div class="flex-1">

            <p class="text-xl text-warm-brown">
              {{ b.date|date:"F j, Y" }} – {{ b.start_time|time:"H:i" }} to {{ b.end_time|time:"H:i" }}
            </p>

            <p>
              <!-- Teacher name, unchanged -->
              <span class="text-lg font-medium">{{ b.teacher_name }}</span>

              <!-- Email with “mail” icon and no parentheses -->
              <span class="inline-flex items-center text-sm text-gray-500 ml-4">
                <!-- Heroicon Mail (outline) -->
                <svg xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4 mr-1 text-warm-brown"
                    fill="none" viewBox="0 0 24 24"
                    stroke="currentColor" stroke-width="1.5">
                    <path d="M1.5 8.67v8.58a3 3 0 0 0 3 3h15a3 3 0 0 0 3-3V8.67l-8.928 5.493a3 3 0 0 1-3.144 0L1.5 8.67Z" />
                    <path d="M22.5 6.908V6.75a3 3 0 0 0-3-3h-15a3 3 0 0 0-3 3v.158l9.714 5.978a1.5 1.5 0 0 0 1.572 0L22.5 6.908Z" />
                </svg>
                {{ b.teacher_email }}
              </span>
            </p>

            {% if b.student_message %}
              <hr class="mt-1 border-1 border-gray-50">
              <p class="mt-1 text-sm text-gray-700 inline-flex items-start space-x-2">
                
                <!-- Heroicon Chat Bubble (outline) -->
                <svg xmlns="http://www.w3.org/2000/svg"
                    class="h-4 w-4 flex-shrink-0 text-warm-brown"
                    fill="none" viewBox="0 0 24 24"
                    stroke="currentColor" stroke-width="1.5">
                  <path fill-rule="evenodd" d="M4.848 2.771A49.144 49.144 0 0 1 12 2.25c2.43 0 4.817.178 7.152.52 1.978.292 3.348 2.024 3.348 3.97v6.02c0 1.946-1.37 3.678-3.348 3.97-1.94.284-3.916.455-5.922.505a.39.39 0 0 0-.266.112L8.78 21.53A.75.75 0 0 1 7.5 21v-3.955a48.842 48.842 0 0 1-2.652-.316c-1.978-.29-3.348-2.024-3.348-3.97V6.741c0-1.946 1.37-3.68 3.348-3.97Z" clip-rule="evenodd" />
                </svg>

                <!-- Actual message in quotes -->
                <span>“{{ b.student_message }}”</span>
              </p>
            {% endif %}
          </div>

          {% if b.teacher_id %}
            <a href="{% url 'teacher_profile_admin' b.teacher_id %}"
                class="inline-flex items-center bg-warm-brown text-white px-3 py-1.5 text-sm font-medium leading-normal rounded-lg shadow-lg
                          transition duration-150 ease-in-out hover:bg-dark-orange focus:outline-none focus:ring-2 focus:ring-warm-brown focus:ring-opacity-50">
              <!-- Eye Icon -->
              <svg xmlns="http://www.w3.org/2000/svg"
                    fill="currentColor" viewBox="0 0 24 24"
                    class="h-5 w-5 mr-2">
                <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                <path fill-rule="evenodd"
                      d="M1.323 11.447C2.811 6.976 7.028 3.75 12.001 
                          3.75c4.97 0 9.185 3.223 10.675 7.69.12.362.12.752 
                          0 1.113-1.487 4.471-5.705 7.697-10.677 7.697-4.97 
                          0-9.186-3.223-10.675-7.69a1.762 1.762 0 0 1 
                          0-1.113ZM17.25 12a5.25 5.25 0 1 1-10.5 0 
                          5.25 5.25 0 0 1 10.5 0Z" clip-rule="evenodd" />
              </svg>
              View Advisor
            </a>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p class="text-gray-600">You have no upcoming bookings.</p>
  {% endif %}

  <hr class="my-6 border-1 border-primary-dark-teal">
  <div class="mt-6 mb-20 text-center">
    {% if request.user.role == 'admin' %}
      <a href="{% url 'admin_dashboard' %}" class="flex items-center justify-center bg-deep-teal text-white px-4 py-2 rounded-lg hover:bg-teal-600">
        Back to Dashboard
      </a>
    {% elif request.user.role == 'student' %}
      <a href="{% url 'student_profile' %}" class="flex items-center justify-center bg-deep-teal text-white px-4 py-2 rounded-lg hover:bg-teal-600">
        Back to Profile
      </a>
    {% endif %}
  </div>

{% endblock %}
